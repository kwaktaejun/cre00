
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>ğŸ“„ ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</h1>

    <form method="POST" onsubmit="return prepareSubmission();">
        <label>ğŸ“ ì—‘ì…€ ì—…ë¡œë“œ:
            <input type="file" id="excelFile" accept=".xlsx">
            
    <button type="button" onclick="uploadExcel()">ğŸ“¤ ì—‘ì…€ ë°ì´í„° ì‚½ì…</button>
    <a href="/static/ì‘ì—…ìš©_í’ˆëª©ì¶”ê°€.xlsx" download>
        <button type="button">ğŸ“„ ì–‘ì‹ ë‹¤ìš´ë¡œë“œ</button>
    </a>
    
        </label>
        <br><br>

        <label>ğŸ“Œ ì—…ë¡œë“œ ë©”ëª¨:
            <textarea name="memo" rows="2" style="width: 100%; margin: 10px 0;" placeholder="ì´ë²ˆ ì—…ë¡œë“œ íšŒì°¨ì— ëŒ€í•œ ê°„ë‹¨í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
        </label>

        <table id="inputTable">
            <thead>
                <tr>
                    <th>êµ¬ë¶„</th><th>ê³„ì•½ì—¬ë¶€</th><th>ì‹ë³„ë²ˆí˜¸</th><th>ê³„ì•½ê¸ˆì•¡</th><th>ì œí’ˆëª¨ë¸ëª…</th><th>í’ˆëª…</th>
                    <th>ëª¨ë¸ëª…</th><th>ê·œê²©</th><th>ìˆ˜ëŸ‰</th><th>ì›ì‚°ì§€</th><th>êµ¬ì„±ì¢…ë¥˜</th>
                    <th>ì œí’ˆì›ê°€</th><th>ì›ì²œì œì¡°ì‚¬</th><th>ìˆ˜ìµë¥ </th><th>ë¹„ê³ </th><th>ë©”ëª¨</th>
                </tr>
            </thead>
            <tbody>
                <tr class="example-row" contenteditable="false">
                    <td>ì£¼ìì¬</td><td>O</td><td>24061854</td><td>1,999,000</td><td>EX03B</td><td>ë³´ì•ˆìš©ì¹´ë©”ë¼</td>
                    <td>CRE-CW21281ZUR</td><td>Bullet Type, 2M, IR</td><td>1</td><td>ëŒ€í•œë¯¼êµ­</td><td>êµ¬ì„±í’ˆ</td>
                    <td>0</td><td>-</td><td>-</td><td>-</td><td>-</td>
                </tr>
                <tr class="example-row" contenteditable="false">
                    <td>ì˜µì…˜í’ˆëª©</td><td></td><td>23411255</td><td>904,000</td><td>CRE-D212812R</td><td>ë³´ì•ˆìš©ì¹´ë©”ë¼</td>
                    <td>-</td><td>Dome type, 2M | í•œí™”(ì‹œíì¸í¬)</td><td>1</td><td>í¬ë¦¬ì—ì´í‹°ë¸Œë„·</td><td>ë‹¨í’ˆ</td>
                    <td>451,000</td><td>í•œí™”</td><td>5.11</td><td>-</td><td>-</td>
                </tr>
                <tr>
                    <td colspan="16"><button type="button" onclick="addRow()">â• í–‰ ì¶”ê°€</button></td>
                </tr>
            </tbody>
        </table>
        <br>
        <input type="hidden" name="tableData" id="tableData">
        <button type="submit">ğŸ“¥ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ</button>
    </form>
</body>
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script>
function uploadExcel() {
    const fileInput = document.getElementById("excelFile");
    const file = fileInput.files[0];
    if (!file) return alert("ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.");

    const reader = new FileReader();
    reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        for (let i = 1; i < rows.length; i++) {
            let row = rows[i];
            let table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
            let newRow = table.insertRow(table.rows.length - 1);
            for (let j = 0; j < 16; j++) {
                let cell = newRow.insertCell(j);
                cell.contentEditable = "true";
                cell.innerText = row[j] || "";
            }
        }
    };
    reader.readAsArrayBuffer(file);
}

function addRow() {
    let table = document.getElementById("inputTable").getElementsByTagName('tbody')[0];
    let row = table.insertRow(table.rows.length - 1);
    for (let i = 0; i < 16; i++) {
        let cell = row.insertCell(i);
        cell.contentEditable = "true";
    }
}

function prepareSubmission() {
    const rows = document.querySelectorAll("#inputTable tbody tr");
    let output = "";
    rows.forEach((row, idx) => {
        if (row.querySelector("td")) {
            const cells = row.querySelectorAll("td");
            if (cells.length === 16) {
                const line = Array.from(cells).map(td => td.innerText.trim()).join("\t");
                output += line + "\n";
            }
        }
    });
    document.getElementById("tableData").value = output;
    return true;
}
</script>
</html>
